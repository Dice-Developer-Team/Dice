std::string(u8R"(
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <title>{{= d.nick }}的Dice WebUI</title>
  <link rel="stylesheet" href="https://unpkg.com/layui@2.6.8/dist/css/layui.css">
  <style>
      .layui-layout-admin .layui-layout-left,
      .layui-layout-admin .layui-body,
      .layui-layout-admin .layui-footer{left: 0;}
      .layui-layout-admin .layui-side{left: -300px;}
      .layui-table-cell{
        height: auto;
        white-space: pre-wrap;
      }
  </style>
</head>
<body>

<div class="layui-layout layui-layout-admin">
  <div class="layui-header">
    <div class="layui-logo layui-hide-xs layui-bg-black">Dice WebUI</div>
    <ul class="layui-nav layui-layout-right">
      <li class="layui-nav-item layui-hide" id="bot-info">
        <a href="javascript:;">
          <img src="https://q1.qlogo.cn/g?b=qq&nk={{= d.qq }}&s=3" class="layui-nav-img" id="qq-avatar">
          <span>{{= d.nick }}</span>
        </a>
      </li>
    </ul>
  </div>

  <div class="layui-body" style="padding: 15px;">
    <div class="layui-tab layui-tab-brief" lay-filter="main">
      <ul class="layui-tab-title">
        <li class="layui-this">主界面</li>
        <li>Master设置</li>
        <li class="layui-hide">用户管理(还没写)</li>
        <li class="layui-hide">群管理(还没写)</li>
        <li>自定义回执</li>
        <li>关键词回复</li>
        <li class="layui-hide">拓展管理(还没写)</li>
        <li>WebUI管理</li>
        <li>更新日志</li>
      </ul>
      <div class="layui-tab-content">
        <div class="layui-tab-item layui-show">
          <div class="layui-row layui-col-space15">
            <div class="layui-col-md6">
              <div class="layui-panel" style="padding: 10px;">
                <div class="layui-text">
                  <h3>基础信息</h3>
                  <p>
                    欢迎使用Dice! WebUI面板
                    <br>
                    常用链接：<a href="https://forum.kokona.tech">论坛</a> <a href="https://v2docs.kokona.tech">文档</a>
                    <br>
                    <span id="basic-info">运行时间：{{= d.running_time }}
                    <br>
                    启动后指令数量：{{= d.cmd_count }}
                    <br>
                    今日指令数量：{{= d.cmd_count_today }}</span>
                    <br>
                  </p>
                </div>
              </div>   
            </div>
            <div class="layui-col-md6">
              <div class="layui-panel layui-hide" style="padding: 10px;">
                <div class="layui-text">
                  <h3>系统信息</h3>
                  <p>
                     还没写还没写还没写 
                  </p>
                </div>
              </div>   
            </div>
          </div>    
        </div>
        <div class="layui-tab-item">
          <form class="layui-form" action="">
            <div class="layui-form-item">
              <label class="layui-form-label">Master</label>
              <div class="layui-input-block">
                <input type="number" name="masterQQ" id="masterQQ" required lay-verify="required|number" placeholder="请输入QQ" autocomplete="off" class="layui-input">
              </div>
            </div>
            <div class="layui-form-item">
              <div class="layui-input-block">
                <button class="layui-btn" lay-submit lay-filter="masterForm">确认</button>
              </div>
            </div>
          </form>
          <table id="admin-config-table" lay-filter="admin-config-table"></table>
        </div>
        <div class="layui-tab-item">

        </div>
        <div class="layui-tab-item">

        </div>
        <div class="layui-tab-item">
          <table id="custom-msg-table" lay-filter="custom-msg-table"></table>
        </div>
        <div class="layui-tab-item">
          <table id="custom-reply-table" lay-filter="custom-reply-table"></table>
        </div>
        <div class="layui-tab-item">

        </div>
        <div class="layui-tab-item">
          <form class="layui-form" action="">
            <div class="layui-form-item">
              <label class="layui-form-label">WebUI密码</label>
              <div class="layui-input-block">
                <input type="password" name="password" id="password" required lay-verify="required|pass" placeholder="请输入新密码" autocomplete="off" class="layui-input">
                <input type="password" required lay-verify="required|passsame" placeholder="请重复输入新密码" autocomplete="off" class="layui-input">
              </div>
            </div>
            <div class="layui-form-item">
              <div class="layui-input-block">
                <button class="layui-btn" lay-submit lay-filter="passwordForm">确认</button>
              </div>
            </div>
          </form>
        </div>
        <div class="layui-tab-item">
          <ul class="layui-timeline">
            <li class="layui-timeline-item">
              <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
              <div class="layui-timeline-content layui-text">
                <h3 class="layui-timeline-title">2021年12月17日 版本2.6.1(592)</h3>
                <p>
                  新增回复前缀匹配
                </p>
              </div>
            </li>
            <li class="layui-timeline-item">
              <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
              <div class="layui-timeline-content layui-text">
                <h3 class="layui-timeline-title">2021年12月12日 版本2.6.1beta4(591)</h3>
                <p>
                  新增获取群内nn/群名片/设置群名片
                </p>
              </div>
            </li>
            <li class="layui-timeline-item">
              <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
              <div class="layui-timeline-content layui-text">
                <h3 class="layui-timeline-title">2021年12月6日 版本2.6.1beta3(590)</h3>
                <p>
                  lua内置http相关函数（get/post）
                </p>
              </div>
            </li>
            <li class="layui-timeline-item">
              <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
              <div class="layui-timeline-content layui-text">
                <h3 class="layui-timeline-title">2021年11月27日 版本2.6.1beta2(589)</h3>
                <p>
                  新增安科/安价指令.ak
                </p>
              </div>
            </li>
            <li class="layui-timeline-item">
              <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
              <div class="layui-timeline-content layui-text">
                <h3 class="layui-timeline-title">2021年11月17日 版本2.6.1beta1(588)</h3>
                <p>
                  适配频道消息
                </p>
              </div>
            </li>
            <li class="layui-timeline-item">
              <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
              <div class="layui-timeline-content layui-text">
                <h3 class="layui-timeline-title">2021年11月3日 版本2.6.0(587)</h3>
                <p>
                  更新ww指令机制
                </p>
              </div>
            </li>
            <li class="layui-timeline-item">
              <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
              <div class="layui-timeline-content layui-text">
                <h3 class="layui-timeline-title">2021年10月1日 版本2.6.0(586)</h3>
                <p>
                  新版触发词回复
                </p>
              </div>
            </li>
            <li class="layui-timeline-item">
              <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
              <div class="layui-timeline-content layui-text">
                <h3 class="layui-timeline-title">2021年9月18日 版本2.6.0(585)</h3>
                <p>
                  WebUI 验证增强
                </p>
              </div>
            </li>
            <li class="layui-timeline-item">
              <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
              <div class="layui-timeline-content layui-text">
                <h3 class="layui-timeline-title">2021年9月17日 版本2.6.0beta(584)</h3>
                <p>
                  WebUI 验证
                  <br>
                  WebUI 基础设置
                  <br>
                  WebUI 关键词回复管理
                  <br>
                  WebUI 正则回复管理
                </p>
              </div>
            </li>
            <li class="layui-timeline-item">
              <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
              <div class="layui-timeline-content layui-text">
                <h3 class="layui-timeline-title">2021年9月16日 版本2.6.0beta(583)</h3>
                <p>
                  基础WebUI框架
                  <br>
                  WebUI 基础信息
                  <br>
                  WebUI Master设置
                  <br>
                  WebUI 自定义内置回执
                </p>
              </div>
            </li>
            <li class="layui-timeline-item">
              <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
              <div class="layui-timeline-content layui-text">
                <div class="layui-timeline-title">过去</div>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <blockquote class="layui-elem-quote layui-hide layui-text" id="footer">当前版本：{{= d.version }}</blockquote>
  </div>
</div>

<script type="text/html" id="editToolbar">
  <div class="layui-btn-container">
    <button class="layui-btn layui-btn-sm" lay-event="edit">编辑</button>
  </div>
</script>

<script type="text/html" id="delToolbar">
  <div class="layui-btn-container">
    <button class="layui-btn layui-btn-sm" lay-event="delete">删除</button>
  </div>
</script>

<script type="text/html" id="addToolbar">
  <div class="layui-btn-container">
    <button class="layui-btn layui-btn-sm" lay-event="add">添加</button>
  </div>
</script>


<form class="layui-form layui-hide" id="addCustomReplyForm" action="" style="padding: 10px;">
  <div class="layui-form-item">
    <label class="layui-form-label" style="width: 50px">关键词</label>
    <div class="layui-input-block" style="margin-left: 80px">
      <input type="text" name="name" required lay-verify="required" placeholder="请输入关键词" autocomplete="off" class="layui-input">
    </div>
  </div>
  <div class="layui-form-item">
    <label class="layui-form-label" style="width: 60px">触发性质</label>
    <div class="layui-input-block" style="margin-left: 90px">
    <select name="type">
      <option value="Reply">回复</option>
      <option value="Order">指令</option>
    </select>
    </div>
  </div>
  <div class="layui-form-item">
    <label class="layui-form-label" style="width: 60px">匹配模式</label>
    <div class="layui-input-block" style="margin-left: 90px">
    <select name="mode">
      <option value="Match">完全</option>
      <option value="Search">模糊</option>
      <option value="Prefix">前缀</option>
      <option value="Regex">正则</option>
    </select>
    </div>
  </div>
  <div class="layui-form-item">
    <label class="layui-form-label" style="width: 60px">回复形式</label>
    <div class="layui-input-block" style="margin-left: 90px">
    <select name="echo">
      <option value ="Deck">牌堆</option>
      <option value ="Text">文本</option>
      <option value ="Lua">Lua</option>
    </select>
    </div>
  </div>
  <div class="layui-form-item">
    <label class="layui-form-label" style="width: 50px">回复</label>
    <div class="layui-input-block" style="margin-left: 80px">
      <!-- TODO: Multiline -->
      <textarea type="text" name="value" required lay-verify="required" placeholder="请输入回复" autocomplete="off" class="layui-textarea"></textarea>
    </div>
  </div>
  <div class="layui-form-item">
    <div class="layui-input-block">
      <button class="layui-btn" lay-submit lay-filter="addCustomReplyForm">添加</button>
    </div>
  </div>
</form>


)") + u8R"(
  
<script src="https://unpkg.com/layui@2.6.8/dist/layui.js"></script>
<script> 
//加载模块  
layui.use(function(){ //亦可加载特定模块：layui.use(['layer', 'laydate', function(){
  //得到各种内置组件
  var layer = layui.layer //弹层
  ,laypage = layui.laypage //分页
  ,laydate = layui.laydate //日期
  ,table = layui.table //表格
  ,carousel = layui.carousel //轮播
  ,upload = layui.upload //上传
  ,element = layui.element //元素操作
  ,slider = layui.slider //滑块
  ,dropdown = layui.dropdown //下拉菜单
  ,form = layui.form
  ,$ = layui.$


  $.get("/api/basicinfo")
    .done(function(data) {
      if (data.code == 0) {
        var titleTpl = lay('title')[0].innerHTML;
        lay('title').html(layui.laytpl(titleTpl).render(data.data));

        var footerTpl = lay('#footer')[0].innerHTML;
        lay('#footer').html(layui.laytpl(footerTpl).render(data.data))
        .removeClass('layui-hide');

        var botInfoTpl = lay('#bot-info')[0].innerHTML;
        lay('#bot-info').html(layui.laytpl(botInfoTpl).render(data.data))
        .removeClass('layui-hide');

        var basicInfoTpl = lay('#basic-info')[0].innerHTML;
        lay('#basic-info').html(layui.laytpl(basicInfoTpl).render(data.data))
        .removeClass('layui-hide');

      } else {
        layer.msg("连接到Dice!后端失败: " + data.msg);
      }
    })
    .fail(function(jqXHR, textStatus, error) {
      layer.msg("连接到Dice!后端失败: " + error);
    })

  //执行一个 table 实例
  table.render({
    elem: '#custom-msg-table'
    ,height: 420
    ,url: '/api/custommsg' //数据接口
    ,title: '自定义回执'
    ,request: {} 
    ,cols: [[ //表头
      {field: 'name', title: '名称', width:150, sort: true, fixed: 'left'}
      ,{field: 'value', title: '值', minWidth:250, edit: 'text'}
      ,{field: 'remark', title: '说明', width:250}
    ]]
    /*,done: function(){
      $(".layui-table-cell").each(function(){
        $(this).html(this.innerHTML.replace(/\n/g,"{br}<br>"));
      })
    }*/
  });

  table.on('edit(custom-msg-table)', function(obj) { 
    obj.data.value = obj.data.value.replace(/<br>/g,"\n").replace(/\{br\}/g,"\n");
    $.post("/api/custommsg", JSON.stringify({action: "set", data: [obj.data]}))
    .done(function(data) {
      if (data.code == 0) {
        layer.msg("回执" + obj.data.name + "保存成功√");
      } else {
        layer.msg("自定义回执保存失败: " + data.msg);
      }
    })
    .fail(function(jqXHR, textStatus, error) {
      layer.msg("自定义回执保存失败: " + error);
    })
  });

  table.render({
    elem: '#admin-config-table'
    ,height: 420
    ,url: '/api/adminconfig' //数据接口
    ,title: '管理员设置'
    ,request: {} 
    ,cols: [[ //表头
      {field: 'name', title: '名称', width:150, sort: true, fixed: 'left'}
      ,{field: 'value', title: '值', minWidth:250, edit: 'text'}
    ]]
  });

  table.on('edit(admin-config-table)', function(obj) { 
    if (obj.data.value >>> 0 !== parseFloat(obj.data.value)) {
      layer.msg("数据无效！值必须是整数");
    } else {
      obj.data.value = obj.data.value >>> 0;
      $.post("/api/adminconfig", JSON.stringify({action: "set", data: [obj.data]}))
      .done(function(data) {
        if (data.code == 0) {
          layer.msg("配置项" + obj.data.name + "保存成功√");
        } else {
          layer.msg("设置保存失败: " + data.msg);
        }
      })
      .fail(function(jqXHR, textStatus, error) {
        layer.msg("设置保存失败: " + error);
      })
    }

  });

  $.get("/api/master")
    .done(function(data) {
      if (data.code == 0) {
        $("#masterQQ").val(data.data.masterQQ);
      }
    })

  form.on('submit(masterForm)', function(data){
    data.field.masterQQ = parseInt(data.field.masterQQ, 10);
    $.post("/api/master", JSON.stringify({action: "set", data: data.field}))
      .done(function(data) {
        if (data.code == 0) {
          layer.msg("Master设置保存成功");
        } else {
          layer.msg("Master设置保存失败: " + data.msg);
        }
      })
      .fail(function(jqXHR, textStatus, error) {
        layer.msg("Master设置保存失败: " + error);
      })
    return false;
  });


  
  var addCustomReplyFormIndex = -1;

  table.render({
    elem: '#custom-reply-table'
    ,height: 420
    ,url: '/api/customreply' //数据接口
    ,title: '关键词回复设置'
    ,toolbar: "#addToolbar"
    ,request: {} 
    ,cols: [[ //表头
      {field: 'name', title: '关键词', width:150, sort: true, fixed: 'left'}
      ,{field: 'type', title: '触发性质', width:100, align: 'center', edit: 'text'}
      ,{field: 'mode', title: '匹配模式', width:100, align: 'center', edit: 'text'}
      ,{field: 'echo', title: '回复形式', width:100, align: 'center', edit: 'text'}
      ,{field: 'value', title: '回复', minWidth:250, edit: 'text'}
      ,{fixed: 'right', width:80, align:'center', toolbar: '#editToolbar'}
      ,{fixed: 'right', width:80, align:'center', toolbar: '#delToolbar'}
    ]]
    /*,done: function(){
      $(".layui-table-cell").each(function(){
        $(this).html(this.innerHTML.replace(/\n/g,"{br}<br>"));
      })
    }*/
  });

  table.on('toolbar(custom-reply-table)', function(obj){
    var checkStatus = table.checkStatus(obj.config.id);
    switch(obj.event){
      case 'add':
        addCustomReplyFormIndex = layer.open({
          type: 1, 
          title: '添加关键词回复',
          content: $("#addCustomReplyForm").removeClass("layui-hide"), //这里content是一个普通的String
          end: function() { $("#addCustomReplyForm").addClass("layui-hide"); }
        });
        break;
    }
  });

  form.on('submit(addCustomReplyForm)', function(data){
    layer.close(addCustomReplyFormIndex);
    
    if(data.field.echo == "Deck"){data.field.value = data.field.value.split("|");}
    $.post("/api/customreply", JSON.stringify({action: "set", data: [data.field]}))
    .done(function(data) {
      if (data.code == 0) {
        layer.msg("关键词回复编辑成功");
        table.reload('custom-reply-table');
      } else {
        layer.msg("关键词回复保存失败: " + data.msg);
      }
    })
    .fail(function(jqXHR, textStatus, error) {
      layer.msg("关键词回复保存失败: " + error);
    })
    
    return false;
  });
  
  //监听行工具事件
  table.on('tool(custom-reply-table)', function(obj){ //注：tool 是工具条事件名，test 是 table 原始容器的属性 lay-filter="对应的值"
    var data = obj.data //获得当前行数据
    ,layEvent = obj.event; //获得 lay-event 对应的值
    if (layEvent == "delete") {
      layer.confirm('确认要删除此行吗？此操作不可撤销。', function(index){
        layer.close(index);
        $.post("/api/customreply", JSON.stringify({action: "delete", data: [obj.data]}))
        .done(function(data) {
          if (data.code == 0) {
            obj.del();
            console.log("CustomReply Delete Success");
          } else {
            layer.msg("关键词回复删除失败: " + data.msg);
          }
        })
        .fail(function(jqXHR, textStatus, error) {
          layer.msg("关键词回复删除失败: " + error);
        })
      });
    }
    else if (layEvent == "edit") {
      addCustomReplyFormIndex = layer.open({
        type: 1, 
        title: '编辑关键词回复',
        content: $("#addCustomReplyForm").removeClass("layui-hide"), //这里content是一个普通的String
        success: function() {
          $("#addCustomReplyForm").find("input[name='name']").val(obj.data.name);
          $("#addCustomReplyForm").find("select[name='mode']").val(obj.data.mode);
          $("#addCustomReplyForm").find("select[name='echo']").val(obj.data.echo);
          $("#addCustomReplyForm").find("textarea[name='value']").val(obj.data.value);
          $("#addCustomReplyForm").find("button").html("编辑");
          layui.form.render('select');
        },
        end: function() { $("#addCustomReplyForm").addClass("layui-hide"); }
      });
    }
  });

  table.on('edit(custom-reply-table)', function(obj) { 
    obj.data.value = obj.data.value.replace(/<br>/g,"\n").replace(/\{br\}/g,"\n");
    if(obj.data.echo == "Deck"){obj.data.value = obj.data.value.split("|");}
    $.post("/api/customreply", JSON.stringify({action: "set", data: [obj.data]}))
    .done(function(data) {
      if (data.code == 0) {
        layer.msg("回复关键词" + obj.data.name + "保存成功√");
      } else {
        layer.msg("关键词回复保存失败: " + data.msg);
      }
    })
    .fail(function(jqXHR, textStatus, error) {
      layer.msg("关键词回复保存失败: " + error);
    })
  });

  form.on('submit(passwordForm)', function(data){
    $.post("/api/webuipassword", JSON.stringify({action: "set", data: data.field}))
    .done(function(data) {
      if (data.code == 0) {
        layer.msg("密码更改成功");
        location.reload();
      } else {
        layer.msg("密码更改失败: " + data.msg);
      }
    })
    .fail(function(jqXHR, textStatus, error) {
      layer.msg("密码更改失败: " + error);
    })
    
    return false;
  });

  form.verify({
    // TODO: Better verification
    pass: [
      /^[\S]{6,20}$/
      ,'密码必须6到20位，且不能出现空格'
    ],
    passsame: function(value, item) {
      if ($(item).parent().children("#password").val() != value) {
        return "两次输入的密码不一致";
      }
    },
    regex: function(value, item) {
      try {
        new RegExp(value);
      } catch(error) {
        return '正则表达式无效';
      }
    }
  });
});
</script>
</body>
</html>        
)"